
<h1>Search Results</h1>

<div class="change_search_result_btn">
  <button class="btn article_btn">記事</button>
  <button class="btn user_btn">ユーザー</button>
</div>

<script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
<script>
$(function() {
  $('.article_btn').on('click', function(){
    $('.searched_articles').show();
    $('.searched_users').hide();
  });
});
$(function() {
  $('.user_btn').on('click', function(){
    $('.searched_users').show();
    $('.searched_articles').hide();
  });
});
</script>

</br>
<table>
  <% @articles.each do |article| %>
    <% if article.is_a?(Article) %>
      <div class = "searched_articles article col-md-4 col-sm-6 col-xs-6">
        <%= link_to(article_path(article.id)) do %>
          <div class = "catch_image">
            <%= image_tag("#{article.catch_image}", size: "390×260") %>
          </div>
        <% end %>
        <div class = "text-information">

          <p class = "created_day">
            <%= article.created_at.to_date %>
          </p>

          <p class = "hashtag">
            <%= render_with_hashtags(article.hashtag) %>
          </p>

          <%= link_to(article_path(article.id)) do %>
            <p class = "article-title">
              <%= article.title.truncate(30) %>
            </p>
          <% end %>

          <div class = "user-info">
            <%= image_tag("#{article.user.icon_image}", class: "user-icon") %>
            <%= link_to article.user.name, user_path(article.user.id) %>
          </div>

          <div class = "text-center">
            <%= article.content.truncate(100).gsub(/<("[^"]*"|'[^']*'|[^'">])*>/,"").gsub(/<img alt=[" a-z=]+.+/, "") %>
          </div>

          <ul class = "article-numbers-info">
              <li id="favorite_btn_<%= article.id %>">
                <%= render partial: "favorites/favorite", locals: {article: article} %>
              </li>
              <li class = "pv_count">
                <%= article.impressionist_count %>PV
              </li>
          </ul>

        </div>
      </div>
    <% else %>
      <% user = article %>
      <tr class = "searched_users">
        <td><%= link_to user.name, user_path(id: user.id ) %></td>
        <td><%= user.introduce_message %></td>
        <% if user != current_user %>
          <td><%= render 'users/follow_form', user: user %></td>
        <% end %>
      </tr>
    <% end %>
  <% end %>
</table>
